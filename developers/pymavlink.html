
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Pymavlink Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-richquotes/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-page-toc-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="sitl.html" />
    
    
    <link rel="prev" href="opencv.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">Introduction</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../introduction/features.html">
            
                <a href="../introduction/features.html">
            
                    
                    Features
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../introduction/applications.html">
            
                <a href="../introduction/applications.html">
            
                    
                    Applications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../introduction/hardware-options.html">
            
                <a href="../introduction/hardware-options.html">
            
                    
                    Hardware Options
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../introduction/hardware-options/connection-diagrams.html">
            
                <a href="../introduction/hardware-options/connection-diagrams.html">
            
                    
                    Connection Diagrams
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../introduction/hardware-options/required-hardware.html">
            
                <a href="../introduction/hardware-options/required-hardware.html">
            
                    
                    Required Hardware
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.2.1" data-path="../introduction/hardware-options/required-hardware/autopilot.html">
            
                <a href="../introduction/hardware-options/required-hardware/autopilot.html">
            
                    
                    Autopilot
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.2" data-path="../introduction/hardware-options/required-hardware/companion-computer.html">
            
                <a href="../introduction/hardware-options/required-hardware/companion-computer.html">
            
                    
                    Companion Computer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.3" data-path="../introduction/hardware-options/required-hardware/camera.html">
            
                <a href="../introduction/hardware-options/required-hardware/camera.html">
            
                    
                    Camera
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.4" data-path="../introduction/hardware-options/required-hardware/escs.html">
            
                <a href="../introduction/hardware-options/required-hardware/escs.html">
            
                    
                    Electronic Speed Controls (ESCs)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.5" data-path="../introduction/hardware-options/required-hardware/thrusters.html">
            
                <a href="../introduction/hardware-options/required-hardware/thrusters.html">
            
                    
                    Thrusters
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.6" data-path="../introduction/hardware-options/required-hardware/power-sensing-module.html">
            
                <a href="../introduction/hardware-options/required-hardware/power-sensing-module.html">
            
                    
                    Power Sensing Module
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.7" data-path="../introduction/hardware-options/required-hardware/power-supply.html">
            
                <a href="../introduction/hardware-options/required-hardware/power-supply.html">
            
                    
                    Power Supply
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.8" data-path="../introduction/hardware-options/required-hardware/tether.html">
            
                <a href="../introduction/hardware-options/required-hardware/tether.html">
            
                    
                    Tether
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.9" data-path="../introduction/hardware-options/required-hardware/topside-computer.html">
            
                <a href="../introduction/hardware-options/required-hardware/topside-computer.html">
            
                    
                    Topside Computer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2.10" data-path="../introduction/hardware-options/required-hardware/joystick.html">
            
                <a href="../introduction/hardware-options/required-hardware/joystick.html">
            
                    
                    Joystick
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../introduction/hardware-options/recommended-extras.html">
            
                <a href="../introduction/hardware-options/recommended-extras.html">
            
                    
                    Recommended Extras
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.3.1" data-path="../introduction/hardware-options/recommended-extras/pressure-sensor.html">
            
                <a href="../introduction/hardware-options/recommended-extras/pressure-sensor.html">
            
                    
                    Pressure Sensor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.2" data-path="../introduction/hardware-options/recommended-extras/camera-gimbal.html">
            
                <a href="../introduction/hardware-options/recommended-extras/camera-gimbal.html">
            
                    
                    Camera Tilt Mount
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3.3" data-path="../introduction/hardware-options/recommended-extras/lights.html">
            
                <a href="../introduction/hardware-options/recommended-extras/lights.html">
            
                    
                    Lights
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../introduction/hardware-options/additional-peripheral-devices.html">
            
                <a href="../introduction/hardware-options/additional-peripheral-devices.html">
            
                    
                    Additional Peripheral Devices
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.4.1" data-path="../introduction/hardware-options/additional-peripheral-devices/leak-sensor.html">
            
                <a href="../introduction/hardware-options/additional-peripheral-devices/leak-sensor.html">
            
                    
                    Leak Sensors
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.2" data-path="../introduction/hardware-options/additional-peripheral-devices/temperature-sensor.html">
            
                <a href="../introduction/hardware-options/additional-peripheral-devices/temperature-sensor.html">
            
                    
                    Temperature Sensor
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.3" data-path="../introduction/hardware-options/additional-peripheral-devices/servos.html">
            
                <a href="../introduction/hardware-options/additional-peripheral-devices/servos.html">
            
                    
                    Servos
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.4" data-path="../introduction/hardware-options/additional-peripheral-devices/relays.html">
            
                <a href="../introduction/hardware-options/additional-peripheral-devices/relays.html">
            
                    
                    Relays
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.5" data-path="../introduction/hardware-options/additional-peripheral-devices/grippers-and-manipulators.html">
            
                <a href="../introduction/hardware-options/additional-peripheral-devices/grippers-and-manipulators.html">
            
                    
                    Grippers and Manipulators
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.6" data-path="../introduction/hardware-options/additional-peripheral-devices/underwater-positioning.html">
            
                <a href="../introduction/hardware-options/additional-peripheral-devices/underwater-positioning.html">
            
                    
                    Underwater Positioning and GPS (SBL and USBL)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4.7" data-path="../introduction/hardware-options/additional-peripheral-devices/sonars.html">
            
                <a href="../introduction/hardware-options/additional-peripheral-devices/sonars.html">
            
                    
                    Sonars
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../introduction/required-software.html">
            
                <a href="../introduction/required-software.html">
            
                    
                    Required Software
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../introduction/required-software/ardusub-autopilot-firmware.html">
            
                <a href="../introduction/required-software/ardusub-autopilot-firmware.html">
            
                    
                    ArduSub Autopilot Firmware
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../introduction/required-software/companion-computer-software.html">
            
                <a href="../introduction/required-software/companion-computer-software.html">
            
                    
                    Companion Computer Software
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../introduction/required-software/qgroundcontrol-software.html">
            
                <a href="../introduction/required-software/qgroundcontrol-software.html">
            
                    
                    QGroundControl Software
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Quick Start</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../quick-start/vehicle-frame.html">
            
                <a href="../quick-start/vehicle-frame.html">
            
                    
                    Building a Vehicle Frame
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../quick-start/installing-qgc.html">
            
                <a href="../quick-start/installing-qgc.html">
            
                    
                    Installing QGroundControl
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../quick-start/installing-companion.html">
            
                <a href="../quick-start/installing-companion.html">
            
                    
                    Installing Companion Software Image
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.3.1" data-path="../quick-start/installing-companion.html">
            
                <a href="../quick-start/installing-companion.html#network-setup">
            
                    
                    Network Setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3.2" data-path="../quick-start/installing-companion.html">
            
                <a href="../quick-start/installing-companion.html#software-update">
            
                    
                    Software Update
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../quick-start/installing-ardusub.html">
            
                <a href="../quick-start/installing-ardusub.html">
            
                    
                    Installing Autopilot Firmware
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.4.1" data-path="../quick-start/installing-ardusub.html">
            
                <a href="../quick-start/installing-ardusub.html#frame-selection">
            
                    
                    Frame Selection
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4.2" data-path="../quick-start/installing-ardusub.html">
            
                <a href="../quick-start/installing-ardusub.html#completing-calibrations">
            
                    
                    Completing Calibrations
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="../quick-start/first-dive.html">
            
                <a href="../quick-start/first-dive.html">
            
                    
                    First Dive
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Reference Documentation</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../reference/qgc-configuration.html">
            
                <a href="../reference/qgc-configuration.html">
            
                    
                    QGroundControl
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="../reference/qgroundcontrol/main-toolbar.html">
            
                <a href="../reference/qgroundcontrol/main-toolbar.html">
            
                    
                    Main Toolbar
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="../reference/qgroundcontrol/application-settings-view.html">
            
                <a href="../reference/qgroundcontrol/application-settings-view.html">
            
                    
                    Application Settings View
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="../reference/qgroundcontrol/vehicle-setup-view.html">
            
                <a href="../reference/qgroundcontrol/vehicle-setup-view.html">
            
                    
                    Vehicle Setup View
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.4" data-path="../reference/qgroundcontrol/plan-view.html">
            
                <a href="../reference/qgroundcontrol/plan-view.html">
            
                    
                    Plan View
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.5" data-path="../reference/qgroundcontrol/fly-view.html">
            
                <a href="../reference/qgroundcontrol/fly-view.html">
            
                    
                    Fly View
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.5.1" data-path="../reference/qgroundcontrol/fly-view.html">
            
                <a href="../reference/qgroundcontrol/fly-view.html#video-stream">
            
                    
                    Recoding Video
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.1.6" data-path="../reference/qgroundcontrol/analyze-view.html">
            
                <a href="../reference/qgroundcontrol/analyze-view.html">
            
                    
                    Analyze View
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.7" data-path="../reference/qgroundcontrol/other-features.html">
            
                <a href="../reference/qgroundcontrol/other-features.html">
            
                    
                    Other Features
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.7.1" data-path="../reference/qgroundcontrol/other-features.html">
            
                <a href="../reference/qgroundcontrol/other-features.html#video-overlay">
            
                    
                    Telemetry Text Overlay Recording
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../reference/ardusub-configuration.html">
            
                <a href="../reference/ardusub-configuration.html">
            
                    
                    ArduSub
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1" data-path="../reference/qgroundcontrol/vehicle-setup-view.html">
            
                <a href="../reference/qgroundcontrol/vehicle-setup-view.html">
            
                    
                    Vehicle Setup View
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1.1" data-path="../reference/ardusub/summary-page.html">
            
                <a href="../reference/ardusub/summary-page.html">
            
                    
                    Summary Page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.1.2" data-path="../reference/ardusub/joystick-setup-page.html">
            
                <a href="../reference/ardusub/joystick-setup-page.html">
            
                    
                    Joystick Setup Page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.1.3" data-path="../reference/ardusub/sensors-setup-page.html">
            
                <a href="../reference/ardusub/sensors-setup-page.html">
            
                    
                    Sensors Setup Page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.1.4" data-path="../reference/ardusub/power-setup-page.html">
            
                <a href="../reference/ardusub/power-setup-page.html">
            
                    
                    Power Setup Page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.1.5" data-path="../reference/ardusub/motors-setup-page.html">
            
                <a href="../reference/ardusub/motors-setup-page.html">
            
                    
                    Motors Setup Page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.1.6" data-path="../reference/ardusub/safety-setup-page.html">
            
                <a href="../reference/ardusub/safety-setup-page.html">
            
                    
                    Safety Setup Page (Failsafes)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.1.7" data-path="../reference/ardusub/tuning-setup-page.html">
            
                <a href="../reference/ardusub/tuning-setup-page.html">
            
                    
                    Tuning Setup Page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.1.8" data-path="../reference/ardusub/camera-mount-setup-page.html">
            
                <a href="../reference/ardusub/camera-mount-setup-page.html">
            
                    
                    Camera Mount Setup Page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.1.9" data-path="../reference/ardusub/lights-setup-page.html">
            
                <a href="../reference/ardusub/lights-setup-page.html">
            
                    
                    Lights Setup Page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.1.10" data-path="../reference/ardusub/frame-setup-page.html">
            
                <a href="../reference/ardusub/frame-setup-page.html">
            
                    
                    Frame Setup Page
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2.1.11" data-path="../reference/ardusub/parameters-page.html">
            
                <a href="../reference/ardusub/parameters-page.html">
            
                    
                    Parameters Page
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.2.2" data-path="../reference/ardusub/features-while-in-operation.html">
            
                <a href="../reference/ardusub/features-while-in-operation.html">
            
                    
                    Features While in Operation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../reference/companion-web-ui.html">
            
                <a href="../reference/companion-web-ui.html">
            
                    
                    Companion Web Interface
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.3.1" data-path="../reference/companion/network.html">
            
                <a href="../reference/companion/network.html">
            
                    
                    Network
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.2" data-path="../reference/companion/system.html">
            
                <a href="../reference/companion/system.html">
            
                    
                    System
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.3" data-path="../reference/companion/camera.html">
            
                <a href="../reference/companion/camera.html">
            
                    
                    Camera
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.4" data-path="../reference/companion/routing.html">
            
                <a href="../reference/companion/routing.html">
            
                    
                    Routing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.5" data-path="../reference/companion/mavproxy.html">
            
                <a href="../reference/companion/mavproxy.html">
            
                    
                    MAVProxy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.6" data-path="../reference/companion/git.html">
            
                <a href="../reference/companion/git.html">
            
                    
                    Git
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.7" data-path="../reference/companion/waterlinked.html">
            
                <a href="../reference/companion/waterlinked.html">
            
                    
                    Water Linked
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.8" data-path="../reference/companion/terminal-over-browser.html">
            
                <a href="../reference/companion/terminal-over-browser.html">
            
                    
                    Terminal Over Browser
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.9" data-path="../reference/companion/file-system.html">
            
                <a href="../reference/companion/file-system.html">
            
                    
                    File System Access
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.10" data-path="../reference/companion/mavlink-rest.html">
            
                <a href="../reference/companion/mavlink-rest.html">
            
                    
                    MAVLink REST API
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="../reference/data-logging.html">
            
                <a href="../reference/data-logging.html">
            
                    
                    Data Logging
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="../reference/troubleshooting.html">
            
                <a href="../reference/troubleshooting.html">
            
                    
                    Troubleshooting
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.5.1" data-path="../reference/troubleshooting.html">
            
                <span>
            
                    
                    Vehicle Control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5.2" data-path="../reference/troubleshooting.html">
            
                <span>
            
                    
                    No Telemetry
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5.3" data-path="../reference/troubleshooting.html">
            
                <span>
            
                    
                    No Video
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5.4" data-path="../reference/troubleshooting.html">
            
                <span>
            
                    
                    Poor Video Streaming
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5.5" data-path="../reference/troubleshooting.html">
            
                <span>
            
                    
                    Miscellaneous
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Developers</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="rc-input-and-output.html">
            
                <a href="rc-input-and-output.html">
            
                    
                    RC Input and Output
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="full-parameter-list.html">
            
                <a href="full-parameter-list.html">
            
                    
                    Full Parameter List
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="software-components.html">
            
                <a href="software-components.html">
            
                    
                    Software Components
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="opencv.html">
            
                <a href="opencv.html">
            
                    
                    OpenCV
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="4.5" data-path="pymavlink.html">
            
                <a href="pymavlink.html">
            
                    
                    Pymavlink
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="sitl.html">
            
                <a href="sitl.html">
            
                    
                    SITL
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.7" data-path="gps-positioning.html">
            
                <a href="gps-positioning.html">
            
                    
                    GPS Positioning
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.8" data-path="wireless-topside.html">
            
                <a href="wireless-topside.html">
            
                    
                    Wireless Topside
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.9" data-path="developers.html">
            
                <a href="developers.html">
            
                    
                    Build ArduSub
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.10" data-path="building-docs.html">
            
                <a href="building-docs.html">
            
                    
                    Build this Documentation
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Resources</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../resources/community.html">
            
                <a href="../resources/community.html">
            
                    
                    Community
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../resources/downloads.html">
            
                <a href="../resources/downloads.html">
            
                    
                    Downloads
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.1" data-path="../resources/downloads.html">
            
                <a href="../resources/downloads.html#qgroundcontrol">
            
                    
                    QGroundControl
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.2" data-path="../resources/downloads.html">
            
                <a href="../resources/downloads.html#ardusub-firmware-files">
            
                    
                    ArduSub Firmware
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.3" data-path="../resources/downloads.html">
            
                <a href="../resources/downloads.html#companion-computer-images">
            
                    
                    Raspberry Pi Image
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="../resources/further-reading.html">
            
                <a href="../resources/further-reading.html">
            
                    
                    Further Reading
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Pymavlink</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="pymavlink">Pymavlink</h1>
<p>ArduSub communicates with a protocol called MAVLink. Pymavlink is a python implementation of the MAVLink protocol. With pymavlink, it is possible to create a python script to read sensor data and send commands to an ArduSub vehicle.</p>
<p>Please reference the pymavlink <a href="https://github.com/ArduPilot/pymavlink" target="_blank">repository</a> and <a href="https://gitter.im/ArduPilot/pymavlink" target="_blank">chat</a> for further information.</p>
<h1 id="safety">Safety</h1>
<p>The autopilot employs a some failsafe mechanisms to keep you and your equipement safe, as well as to prevent your ROV from running away from you during experiments.</p>
<p>All system components that communicate via MAVLink are expected to send a HEARTBEAT message at a constant rate of at least 1 Hz. If the autopilot does not receive a heartbeat from your application after this interval, it will trigger a <a href="../operators-manual/failsafes.html">failsafe</a>.</p>
<p>When the autopilot is being commanded to move via RC_CHANNELS_RAW or MANUAL_CONTROL messages, the messages must be sent at a constant rate like the HEARTBEAT message. Otherwise, the autopilot will execute a failsafe if it has not received an updated command after a timeout period.</p>
<h2 id="installation">Installation</h2>
<h4 id="ubuntu-1604">Ubuntu 16.04</h4>
<pre><code class="lang-sh"><span class="hljs-comment"># Update list of available packages</span>
apt update

<span class="hljs-comment"># Install some dependencies</span>
apt install python python-pip python-future

<span class="hljs-comment"># Install mavproxy module and everything else needed</span>
pip install mavproxy
</code></pre>
<h5 id="test-installation">Test installation</h5>
<p>You can test your installation with python interactive shell.</p>
<pre><code class="lang-bash">python
import pymavlink
<span class="hljs-built_in">print</span>(pymavlink.__doc__)
</code></pre>
<p>Output:</p>
<pre><code class="lang-bash">Python MAVLink library - see http://www.qgroundcontrol.org/mavlink/mavproxy_startpage
</code></pre>
<p>Note that <code>pymavlink.__doc__</code> will show some information about the package.
This is a record of this example running in python interactive shell:</p>
<p><a href="https://asciinema.org/a/237333" target="_blank"><img src="https://asciinema.org/a/237333.svg" alt="asciicast"></a></p>
<h1 id="examples">Examples</h1>
<p>Pymavlink has 3 types of messages:</p>
<ul>
<li><code>command_long_send</code>: To create a raw package</li>
<li><code>&lt;message_name&gt;_send</code>: To send simple mavlink messages</li>
<li><code>mavutil</code>: Functions to abstract some MAVLink messages</li>
</ul>
<h3 id="connect">Connect</h3>
<p>There are 3 types of udp connections for <code>mavlink_connection</code>:</p>
<ul>
<li><strong>udpout</strong>: Outputs data to a specified address:port (client).</li>
<li><strong>udpbcast</strong>: Broadcasts and locks to the first client to respond (does not handle multiple clients properly)<ul>
<li>Using the IP <code>192.168.1.255</code> all devices from  <code>192.168.1.1</code> to <code>192.168.1.255</code> will receive the data.</li>
</ul>
</li>
<li><strong>udpin</strong>: Binds to a specific port in address:port (server), it&apos;s necessary to receive data from clients (<strong>udpout</strong>) before starting to send any data.</li>
<li><strong>udp</strong>: Exists for legacy reasons, works as <strong>udpin</strong>.</li>
</ul>
<h5 id="autopilot-eg-pixhawk-connected-to-the-computer-via-serial">Autopilot (E.g: Pixhawk) connected to the computer via serial</h5>
<pre><code class="lang-python"><span class="hljs-string">&quot;&quot;&quot;
Example of connecting to an autopilot via serial communication using pymavlink
&quot;&quot;&quot;</span>

<span class="hljs-comment"># Import mavutil</span>
<span class="hljs-keyword">from</span> pymavlink <span class="hljs-keyword">import</span> mavutil

<span class="hljs-comment"># Create the connection</span>
<span class="hljs-comment"># Need to provide the serial port and baudrate</span>
master = mavutil.mavlink_connection(<span class="hljs-string">&quot;/dev/ttyACM0&quot;</span>, baud=<span class="hljs-number">115200</span>)

<span class="hljs-comment"># Restart the ArduSub board !</span>
master.reboot_autopilot()
</code></pre>
<h5 id="run-pymavlink-on-the-surface-computer">Run pyMavlink on the surface computer</h5>
<pre><code class="lang-python"><span class="hljs-string">&quot;&quot;&quot;
Example of how to connect pymavlink to an autopilot via an UDP connection
&quot;&quot;&quot;</span>

<span class="hljs-comment"># Disable &quot;Bare exception&quot; warning</span>
<span class="hljs-comment"># pylint: disable=W0702</span>

<span class="hljs-keyword">import</span> time
<span class="hljs-comment"># Import mavutil</span>
<span class="hljs-keyword">from</span> pymavlink <span class="hljs-keyword">import</span> mavutil

<span class="hljs-comment"># Create the connection</span>
<span class="hljs-comment">#  If using a companion computer</span>
<span class="hljs-comment">#  the default connection is available</span>
<span class="hljs-comment">#  at ip 192.168.2.1 and the port 14550</span>
<span class="hljs-comment"># Note: The connection is done with &apos;udpin&apos; and not &apos;udpout&apos;.</span>
<span class="hljs-comment">#  You can check in http:192.168.2.2:2770/mavproxy that the communication made for 14550</span>
<span class="hljs-comment">#  uses a &apos;udpbcast&apos; (client) and not &apos;udpin&apos; (server).</span>
<span class="hljs-comment">#  If you want to use QGroundControl in parallel with your python script,</span>
<span class="hljs-comment">#  it&apos;s possible to add a new output port in http:192.168.2.2:2770/mavproxy as a new line.</span>
<span class="hljs-comment">#  E.g: --out udpbcast:192.168.2.255:yourport</span>
master = mavutil.mavlink_connection(<span class="hljs-string">&apos;udpin:0.0.0.0:14550&apos;</span>)

<span class="hljs-comment"># Get some information !</span>
<span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
    <span class="hljs-keyword">try</span>:
        print(master.recv_match().to_dict())
    <span class="hljs-keyword">except</span>:
        <span class="hljs-keyword">pass</span>
    time.sleep(<span class="hljs-number">0.1</span>)

<span class="hljs-comment"># Output:</span>
<span class="hljs-comment"># {&apos;mavpackettype&apos;: &apos;AHRS2&apos;, &apos;roll&apos;: -0.11364290863275528, &apos;pitch&apos;: -0.02841472253203392, &apos;yaw&apos;: 2.0993032455444336, &apos;altitude&apos;: 0.0, &apos;lat&apos;: 0, &apos;lng&apos;: 0}</span>
<span class="hljs-comment"># {&apos;mavpackettype&apos;: &apos;AHRS3&apos;, &apos;roll&apos;: 0.025831475853919983, &apos;pitch&apos;: 0.006112074479460716, &apos;yaw&apos;: 2.1514968872070312, &apos;altitude&apos;: 0.0, &apos;lat&apos;: 0, &apos;lng&apos;: 0, &apos;v1&apos;: 0.0, &apos;v2&apos;: 0.0, &apos;v3&apos;: 0.0, &apos;v4&apos;: 0.0}</span>
<span class="hljs-comment"># {&apos;mavpackettype&apos;: &apos;VFR_HUD&apos;, &apos;airspeed&apos;: 0.0, &apos;groundspeed&apos;: 0.0, &apos;heading&apos;: 123, &apos;throttle&apos;: 0, &apos;alt&apos;: 3.129999876022339, &apos;climb&apos;: 3.2699999809265137}</span>
<span class="hljs-comment"># {&apos;mavpackettype&apos;: &apos;AHRS&apos;, &apos;omegaIx&apos;: 0.0014122836291790009, &apos;omegaIy&apos;: -0.022567369043827057, &apos;omegaIz&apos;: 0.02394154854118824, &apos;accel_weight&apos;: 0.0, &apos;renorm_val&apos;: 0.0, &apos;error_rp&apos;: 0.08894175291061401, &apos;error_yaw&apos;: 0.0990816056728363}</span>
</code></pre>
<h5 id="run-pymavlink-on-the-companion-computer">Run pyMavlink on the companion computer</h5>
<pre><code class="lang-python"><span class="hljs-string">&quot;&quot;&quot;
Example of how to connect to the autopilot by using mavproxy&apos;s
--udpin:0.0.0.0:9000 endpoint from the companion computer itself
&quot;&quot;&quot;</span>

<span class="hljs-comment"># Disable &quot;Bare exception&quot; warning</span>
<span class="hljs-comment"># pylint: disable=W0702</span>

<span class="hljs-keyword">import</span> time
<span class="hljs-comment"># Import mavutil</span>
<span class="hljs-keyword">from</span> pymavlink <span class="hljs-keyword">import</span> mavutil

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wait_conn</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    Sends a ping to stabilish the UDP communication and awaits for a response
    &quot;&quot;&quot;</span>
    msg = <span class="hljs-keyword">None</span>
    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> msg:
        master.mav.ping_send(
            int(time.time() * <span class="hljs-number">1e6</span>), <span class="hljs-comment"># Unix time in microseconds</span>
            <span class="hljs-number">0</span>, <span class="hljs-comment"># Ping number</span>
            <span class="hljs-number">0</span>, <span class="hljs-comment"># Request ping of all systems</span>
            <span class="hljs-number">0</span> <span class="hljs-comment"># Request ping of all components</span>
        )
        msg = master.recv_match()
        time.sleep(<span class="hljs-number">0.5</span>)

<span class="hljs-comment"># Create the connection</span>
<span class="hljs-comment">#  Companion is already configured to allow script connections under the port 9000</span>
<span class="hljs-comment"># Note: The connection is done with &apos;udpout&apos; and not &apos;udpin&apos;.</span>
<span class="hljs-comment">#  You can check in http:192.168.1.2:2770/mavproxy that the communication made for 9000</span>
<span class="hljs-comment">#  uses a &apos;udp&apos; (server) and not &apos;udpout&apos; (client).</span>
master = mavutil.mavlink_connection(<span class="hljs-string">&apos;udpout:0.0.0.0:9000&apos;</span>)

<span class="hljs-comment"># Send a ping to start connection and wait for any reply.</span>
<span class="hljs-comment">#  This function is necessary when using &apos;udpout&apos;,</span>
<span class="hljs-comment">#  as described before, &apos;udpout&apos; connects to &apos;udpin&apos;,</span>
<span class="hljs-comment">#  and needs to send something to allow &apos;udpin&apos; to start</span>
<span class="hljs-comment">#  sending data.</span>
wait_conn()

<span class="hljs-comment"># Get some information !</span>
<span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
    <span class="hljs-keyword">try</span>:
        print(master.recv_match().to_dict())
    <span class="hljs-keyword">except</span>:
        <span class="hljs-keyword">pass</span>
    time.sleep(<span class="hljs-number">0.1</span>)

<span class="hljs-comment"># Output:</span>
<span class="hljs-comment"># {&apos;mavpackettype&apos;: &apos;AHRS2&apos;, &apos;roll&apos;: -0.11364290863275528, &apos;pitch&apos;: -0.02841472253203392, &apos;yaw&apos;: 2.0993032455444336, &apos;altitude&apos;: 0.0, &apos;lat&apos;: 0, &apos;lng&apos;: 0}</span>
<span class="hljs-comment"># {&apos;mavpackettype&apos;: &apos;AHRS3&apos;, &apos;roll&apos;: 0.025831475853919983, &apos;pitch&apos;: 0.006112074479460716, &apos;yaw&apos;: 2.1514968872070312, &apos;altitude&apos;: 0.0, &apos;lat&apos;: 0, &apos;lng&apos;: 0, &apos;v1&apos;: 0.0, &apos;v2&apos;: 0.0, &apos;v3&apos;: 0.0, &apos;v4&apos;: 0.0}</span>
<span class="hljs-comment"># {&apos;mavpackettype&apos;: &apos;VFR_HUD&apos;, &apos;airspeed&apos;: 0.0, &apos;groundspeed&apos;: 0.0, &apos;heading&apos;: 123, &apos;throttle&apos;: 0, &apos;alt&apos;: 3.129999876022339, &apos;climb&apos;: 3.2699999809265137}</span>
<span class="hljs-comment"># {&apos;mavpackettype&apos;: &apos;AHRS&apos;, &apos;omegaIx&apos;: 0.0014122836291790009, &apos;omegaIy&apos;: -0.022567369043827057, &apos;omegaIz&apos;: 0.02394154854118824, &apos;accel_weight&apos;: 0.0, &apos;renorm_val&apos;: 0.0, &apos;error_rp&apos;: 0.08894175291061401, &apos;error_yaw&apos;: 0.0990816056728363}</span>
</code></pre>
<h5 id="change-flight-mode">Change flight mode</h5>
<pre><code class="lang-python"><span class="hljs-string">&quot;&quot;&quot;
Example of how to change flight modes using pymavlink
&quot;&quot;&quot;</span>

<span class="hljs-keyword">import</span> sys
<span class="hljs-comment"># Import mavutil</span>
<span class="hljs-keyword">from</span> pymavlink <span class="hljs-keyword">import</span> mavutil

<span class="hljs-comment"># Create the connection</span>
master = mavutil.mavlink_connection(<span class="hljs-string">&apos;udpin:0.0.0.0:14550&apos;</span>)
<span class="hljs-comment"># Wait a heartbeat before sending commands</span>
master.wait_heartbeat()

<span class="hljs-comment"># Choose a mode</span>
mode = <span class="hljs-string">&apos;STABILIZE&apos;</span>

<span class="hljs-comment"># Check if mode is available</span>
<span class="hljs-keyword">if</span> mode <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> master.mode_mapping():
    print(<span class="hljs-string">&apos;Unknown mode : {}&apos;</span>.format(mode))
    print(<span class="hljs-string">&apos;Try:&apos;</span>, list(master.mode_mapping().keys()))
    sys.exit(<span class="hljs-number">1</span>)

<span class="hljs-comment"># Get mode ID</span>
mode_id = master.mode_mapping()[mode]
<span class="hljs-comment"># Set new mode</span>
<span class="hljs-comment"># master.mav.command_long_send(</span>
<span class="hljs-comment">#    master.target_system, master.target_component,</span>
<span class="hljs-comment">#    mavutil.mavlink.MAV_CMD_DO_SET_MODE, 0,</span>
<span class="hljs-comment">#    0, mode_id, 0, 0, 0, 0, 0) or:</span>
<span class="hljs-comment"># master.set_mode(mode_id) or:</span>
master.mav.set_mode_send(
    master.target_system,
    mavutil.mavlink.MAV_MODE_FLAG_CUSTOM_MODE_ENABLED,
    mode_id)

<span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
    <span class="hljs-comment"># Wait for ACK command</span>
    ack_msg = master.recv_match(type=<span class="hljs-string">&apos;COMMAND_ACK&apos;</span>, blocking=<span class="hljs-keyword">True</span>)
    ack_msg = ack_msg.to_dict()

    <span class="hljs-comment"># Check if command in the same in `set_mode`</span>
    <span class="hljs-keyword">if</span> ack_msg[<span class="hljs-string">&apos;command&apos;</span>] != mavutil.mavlink.MAVLINK_MSG_ID_SET_MODE:
        <span class="hljs-keyword">continue</span>

    <span class="hljs-comment"># Print the ACK result !</span>
    print(mavutil.mavlink.enums[<span class="hljs-string">&apos;MAV_RESULT&apos;</span>][ack_msg[<span class="hljs-string">&apos;result&apos;</span>]].description)
    <span class="hljs-keyword">break</span>
</code></pre>
<h5 id="armdisarm-the-vehicle">Arm/Disarm the vehicle</h5>
<pre><code class="lang-python"><span class="hljs-string">&quot;&quot;&quot;
Example of how to Arm and Disarm an Autopilot with pymavlink
&quot;&quot;&quot;</span>
<span class="hljs-comment"># Import mavutil</span>
<span class="hljs-keyword">from</span> pymavlink <span class="hljs-keyword">import</span> mavutil

<span class="hljs-comment"># Create the connection</span>
master = mavutil.mavlink_connection(<span class="hljs-string">&apos;udpin:0.0.0.0:14550&apos;</span>)
<span class="hljs-comment"># Wait a heartbeat before sending commands</span>
master.wait_heartbeat()

<span class="hljs-comment"># https://mavlink.io/en/messages/common.html#MAV_CMD_COMPONENT_ARM_DISARM</span>

<span class="hljs-comment"># Arm</span>
<span class="hljs-comment"># master.arducopter_arm() or:</span>
master.mav.command_long_send(
    master.target_system,
    master.target_component,
    mavutil.mavlink.MAV_CMD_COMPONENT_ARM_DISARM,
    <span class="hljs-number">0</span>,
    <span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)

<span class="hljs-comment"># Disarm</span>
<span class="hljs-comment"># master.arducopter_disarm() or:</span>
master.mav.command_long_send(
    master.target_system,
    master.target_component,
    mavutil.mavlink.MAV_CMD_COMPONENT_ARM_DISARM,
    <span class="hljs-number">0</span>,
    <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)
</code></pre>
<h5 id="send-rc-joystick">Send RC (Joystick)</h5>
<pre><code class="lang-python"><span class="hljs-string">&quot;&quot;&quot;
Example of how to use RC_CHANNEL_OVERRIDE messages to force input channels
in Ardupilot. These effectively replace the input channels (from joystick
or radio), NOT the output channels going to thrusters and servos.
&quot;&quot;&quot;</span>

<span class="hljs-comment"># Import mavutil</span>
<span class="hljs-keyword">from</span> pymavlink <span class="hljs-keyword">import</span> mavutil

<span class="hljs-comment"># Create the connection</span>
master = mavutil.mavlink_connection(<span class="hljs-string">&apos;udpin:0.0.0.0:14550&apos;</span>)
<span class="hljs-comment"># Wait a heartbeat before sending commands</span>
master.wait_heartbeat()

<span class="hljs-comment"># Create a function to send RC values</span>
<span class="hljs-comment"># More information about Joystick channels</span>
<span class="hljs-comment"># here: https://www.ardusub.com/operators-manual/rc-input-and-output.html#rc-inputs</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">set_rc_channel_pwm</span><span class="hljs-params">(channel_id, pwm=<span class="hljs-number">1500</span>)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot; Set RC channel pwm value
    Args:
        channel_id (TYPE): Channel ID
        pwm (int, optional): Channel pwm value 1100-1900
    &quot;&quot;&quot;</span>
    <span class="hljs-keyword">if</span> channel_id &lt; <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> channel_id &gt; <span class="hljs-number">18</span>:
        print(<span class="hljs-string">&quot;Channel does not exist.&quot;</span>)
        <span class="hljs-keyword">return</span>

    <span class="hljs-comment"># Mavlink 2 supports up to 18 channels:</span>
    <span class="hljs-comment"># https://mavlink.io/en/messages/common.html#RC_CHANNELS_OVERRIDE</span>
    rc_channel_values = [<span class="hljs-number">65535</span> <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(<span class="hljs-number">18</span>)]
    rc_channel_values[channel_id - <span class="hljs-number">1</span>] = pwm
    master.mav.rc_channels_override_send(
        master.target_system,                <span class="hljs-comment"># target_system</span>
        master.target_component,             <span class="hljs-comment"># target_component</span>
        *rc_channel_values)                  <span class="hljs-comment"># RC channel list, in microseconds.</span>


<span class="hljs-comment"># Set some roll</span>
set_rc_channel_pwm(<span class="hljs-number">2</span>, <span class="hljs-number">1600</span>)

<span class="hljs-comment"># Set some yaw</span>
set_rc_channel_pwm(<span class="hljs-number">4</span>, <span class="hljs-number">1600</span>)

<span class="hljs-comment"># The camera pwm value is the servo speed</span>
<span class="hljs-comment"># and not the servo position</span>
<span class="hljs-comment"># Set camera tilt to 45&#xBA; with full speed</span>
set_rc_channel_pwm(<span class="hljs-number">8</span>, <span class="hljs-number">1900</span>)

<span class="hljs-comment"># Set channel 12 to 1500us</span>
<span class="hljs-comment"># This can be used to control a device connected to a servo output by setting the</span>
<span class="hljs-comment"># SERVO[N]_Function to RCIN12 (Where N is one of the PWM outputs)</span>
set_rc_channel_pwm(<span class="hljs-number">12</span>, <span class="hljs-number">1500</span>)
</code></pre>
<h4 id="send-manual-control">Send Manual Control</h4>
<pre><code class="lang-python"><span class="hljs-string">&quot;&quot;&quot;
Example of how to send MANUAL_CONTROL messages to the autopilot using
pymavlink.
This message is able to fully replace the joystick inputs.
&quot;&quot;&quot;</span>

<span class="hljs-comment"># Import mavutil</span>
<span class="hljs-keyword">from</span> pymavlink <span class="hljs-keyword">import</span> mavutil

<span class="hljs-comment"># Create the connection</span>
master = mavutil.mavlink_connection(<span class="hljs-string">&apos;udpin:0.0.0.0:14550&apos;</span>)
<span class="hljs-comment"># Wait a heartbeat before sending commands</span>
master.wait_heartbeat()

<span class="hljs-comment"># Send a positive x value, negative y, negative z,</span>
<span class="hljs-comment"># positive rotation and no button.</span>
<span class="hljs-comment"># https://mavlink.io/en/messages/common.html#MANUAL_CONTROL</span>
<span class="hljs-comment"># Warning: Because of some legacy workaround, z will work between [0-1000]</span>
<span class="hljs-comment"># where 0 is full reverse, 500 is no output and 1000 is full throttle.</span>
<span class="hljs-comment"># x,y and r will be between [-1000 and 1000].</span>
master.mav.manual_control_send(
    master.target_system,
    <span class="hljs-number">500</span>,
    <span class="hljs-number">-500</span>,
    <span class="hljs-number">250</span>,
    <span class="hljs-number">500</span>,
    <span class="hljs-number">0</span>)

<span class="hljs-comment"># To active button 0 (first button), 3 (fourth button) and 7 (eighth button)</span>
<span class="hljs-comment"># It&apos;s possible to check and configure this buttons in the Joystick menu of QGC</span>
buttons = <span class="hljs-number">1</span> + <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">3</span> + <span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">7</span>
master.mav.manual_control_send(
    master.target_system,
    <span class="hljs-number">0</span>,
    <span class="hljs-number">0</span>,
    <span class="hljs-number">500</span>, <span class="hljs-comment"># 500 means neutral throttle</span>
    <span class="hljs-number">0</span>,
    buttons)
</code></pre>
<h4 id="control-camera-gimbal">Control Camera Gimbal</h4>
<pre><code class="lang-python"><span class="hljs-string">&quot;&quot;&quot;
Example of controlling a camera gimbal using pymavlink
&quot;&quot;&quot;</span>

<span class="hljs-keyword">import</span> time
<span class="hljs-comment"># Import mavutil</span>
<span class="hljs-keyword">from</span> pymavlink <span class="hljs-keyword">import</span> mavutil

<span class="hljs-comment"># Create the connection</span>
master = mavutil.mavlink_connection(<span class="hljs-string">&apos;udpin:0.0.0.0:14550&apos;</span>)
<span class="hljs-comment"># Wait a heartbeat before sending commands</span>
master.wait_heartbeat()


<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">look_at</span><span class="hljs-params">(tilt, roll=<span class="hljs-number">0</span>, pan=<span class="hljs-number">0</span>)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    Moves gimbal to given position
    Args:
        tilt (float): tilt angle in centidegrees (0 is forward)
        roll (float, optional): pan angle in centidegrees (0 is forward)
        pan  (float, optional): pan angle in centidegrees (0 is forward)
    &quot;&quot;&quot;</span>
    master.mav.command_long_send(
        master.target_system,
        master.target_component,
        mavutil.mavlink.MAV_CMD_DO_MOUNT_CONTROL,
        <span class="hljs-number">1</span>,
        tilt,
        roll,
        pan,
        <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,
        mavutil.mavlink.MAV_MOUNT_MODE_MAVLINK_TARGETING)


<span class="hljs-comment"># cycles the camera up and down</span>
<span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
    <span class="hljs-keyword">for</span> angle <span class="hljs-keyword">in</span> range(<span class="hljs-number">-50</span>, <span class="hljs-number">50</span>):
        look_at(angle*<span class="hljs-number">100</span>)
        time.sleep(<span class="hljs-number">0.1</span>)
    <span class="hljs-keyword">for</span> angle <span class="hljs-keyword">in</span> range(<span class="hljs-number">-50</span>, <span class="hljs-number">50</span>):
        look_at(-angle*<span class="hljs-number">100</span>)
        time.sleep(<span class="hljs-number">0.1</span>)
</code></pre>
<h4 id="read-all-parameters">Read all parameters</h4>
<pre><code class="lang-python"><span class="hljs-string">&quot;&quot;&quot;
Example of how to read all the parameters from the Autopilot with pymavlink
&quot;&quot;&quot;</span>

<span class="hljs-comment"># Disable &quot;Broad exception&quot; warning</span>
<span class="hljs-comment"># pylint: disable=W0703</span>

<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> sys

<span class="hljs-comment"># Import mavutil</span>
<span class="hljs-keyword">from</span> pymavlink <span class="hljs-keyword">import</span> mavutil


<span class="hljs-comment"># Create the connection</span>
master = mavutil.mavlink_connection(<span class="hljs-string">&apos;udp:0.0.0.0:14550&apos;</span>)
<span class="hljs-comment"># Wait a heartbeat before sending commands</span>
master.wait_heartbeat()

<span class="hljs-comment"># Request all parameters</span>
master.mav.param_request_list_send(
    master.target_system, master.target_component
)
<span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
    time.sleep(<span class="hljs-number">0.01</span>)
    <span class="hljs-keyword">try</span>:
        message = master.recv_match(type=<span class="hljs-string">&apos;PARAM_VALUE&apos;</span>, blocking=<span class="hljs-keyword">True</span>).to_dict()
        print(<span class="hljs-string">&apos;name: %s\tvalue: %d&apos;</span> % (message[<span class="hljs-string">&apos;param_id&apos;</span>],
                                       message[<span class="hljs-string">&apos;param_value&apos;</span>]))
    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> error:
        print(error)
        sys.exit(<span class="hljs-number">0</span>)
</code></pre>
<h4 id="read-and-write-parameters">Read and write parameters</h4>
<pre><code class="lang-python"><span class="hljs-string">&quot;&quot;&quot;
Example code of how to read and write vehicle parameters using pymavlink
&quot;&quot;&quot;</span>

<span class="hljs-keyword">import</span> time
<span class="hljs-comment"># Import mavutil</span>
<span class="hljs-keyword">from</span> pymavlink <span class="hljs-keyword">import</span> mavutil

<span class="hljs-comment"># Create the connection</span>
master = mavutil.mavlink_connection(<span class="hljs-string">&apos;udp:0.0.0.0:14550&apos;</span>)
<span class="hljs-comment"># Wait a heartbeat before sending commands</span>
master.wait_heartbeat()

<span class="hljs-comment"># Request parameter</span>
master.mav.param_request_read_send(
    master.target_system, master.target_component,
    <span class="hljs-string">b&apos;SURFACE_DEPTH&apos;</span>,
    <span class="hljs-number">-1</span>
)

<span class="hljs-comment"># Print old parameter value</span>
message = master.recv_match(type=<span class="hljs-string">&apos;PARAM_VALUE&apos;</span>, blocking=<span class="hljs-keyword">True</span>).to_dict()
print(<span class="hljs-string">&apos;name: %s\tvalue: %d&apos;</span> %
      (message[<span class="hljs-string">&apos;param_id&apos;</span>].decode(<span class="hljs-string">&quot;utf-8&quot;</span>), message[<span class="hljs-string">&apos;param_value&apos;</span>]))

time.sleep(<span class="hljs-number">1</span>)

<span class="hljs-comment"># Set parameter value</span>
<span class="hljs-comment"># Set a parameter value TEMPORARILY to RAM. It will be reset to default on system reboot.</span>
<span class="hljs-comment"># Send the ACTION MAV_ACTION_STORAGE_WRITE to PERMANENTLY write the RAM contents to EEPROM.</span>
<span class="hljs-comment"># The parameter variable type is described by MAV_PARAM_TYPE in http://mavlink.org/messages/common.</span>
master.mav.param_set_send(
    master.target_system, master.target_component,
    <span class="hljs-string">b&apos;SURFACE_DEPTH&apos;</span>,
    <span class="hljs-number">-12</span>,
    mavutil.mavlink.MAV_PARAM_TYPE_REAL32
)

<span class="hljs-comment"># Read ACK</span>
<span class="hljs-comment"># IMPORTANT: The receiving component should acknowledge the new parameter value by sending a</span>
<span class="hljs-comment"># param_value message to all communication partners.</span>
<span class="hljs-comment"># This will also ensure that multiple GCS all have an up-to-date list of all parameters.</span>
<span class="hljs-comment"># If the sending GCS did not receive a PARAM_VALUE message within its timeout time,</span>
<span class="hljs-comment"># it should re-send the PARAM_SET message.</span>
message = master.recv_match(type=<span class="hljs-string">&apos;PARAM_VALUE&apos;</span>, blocking=<span class="hljs-keyword">True</span>).to_dict()
print(<span class="hljs-string">&apos;name: %s\tvalue: %d&apos;</span> %
      (message[<span class="hljs-string">&apos;param_id&apos;</span>].decode(<span class="hljs-string">&quot;utf-8&quot;</span>), message[<span class="hljs-string">&apos;param_value&apos;</span>]))

time.sleep(<span class="hljs-number">1</span>)

<span class="hljs-comment"># Request parameter value to confirm</span>
master.mav.param_request_read_send(
    master.target_system, master.target_component,
    <span class="hljs-string">b&apos;SURFACE_DEPTH&apos;</span>,
    <span class="hljs-number">-1</span>
)

<span class="hljs-comment"># Print new value in RAM</span>
message = master.recv_match(type=<span class="hljs-string">&apos;PARAM_VALUE&apos;</span>, blocking=<span class="hljs-keyword">True</span>).to_dict()
print(<span class="hljs-string">&apos;name: %s\tvalue: %d&apos;</span> %
      (message[<span class="hljs-string">&apos;param_id&apos;</span>].decode(<span class="hljs-string">&quot;utf-8&quot;</span>), message[<span class="hljs-string">&apos;param_value&apos;</span>]))
</code></pre>
<h4 id="send-gps-position">Send GPS position</h4>
<pre><code class="lang-python"><span class="hljs-string">&quot;&quot;&quot;
Example of how to send GPS_INPUT messages to autopilot
&quot;&quot;&quot;</span>

<span class="hljs-keyword">import</span> time
<span class="hljs-comment"># Import mavutil</span>
<span class="hljs-keyword">from</span> pymavlink <span class="hljs-keyword">import</span> mavutil

<span class="hljs-comment"># Create the connection</span>
master = mavutil.mavlink_connection(<span class="hljs-string">&apos;udpin:0.0.0.0:14550&apos;</span>)
<span class="hljs-comment"># Wait a heartbeat before sending commands</span>
master.wait_heartbeat()

<span class="hljs-comment"># GPS_TYPE need to be MAV</span>
<span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
    time.sleep(<span class="hljs-number">0.2</span>)
    master.mav.gps_input_send(
        <span class="hljs-number">0</span>,  <span class="hljs-comment"># Timestamp (micros since boot or Unix epoch)</span>
        <span class="hljs-number">0</span>,  <span class="hljs-comment"># ID of the GPS for multiple GPS inputs</span>
        <span class="hljs-comment"># Flags indicating which fields to ignore (see GPS_INPUT_IGNORE_FLAGS enum).</span>
        <span class="hljs-comment"># All other fields must be provided.</span>
        <span class="hljs-number">8</span> | <span class="hljs-number">16</span> | <span class="hljs-number">32</span>,
        <span class="hljs-number">0</span>,  <span class="hljs-comment"># GPS time (milliseconds from start of GPS week)</span>
        <span class="hljs-number">0</span>,  <span class="hljs-comment"># GPS week number</span>
        <span class="hljs-number">3</span>,  <span class="hljs-comment"># 0-1: no fix, 2: 2D fix, 3: 3D fix. 4: 3D with DGPS. 5: 3D with RTK</span>
        <span class="hljs-number">0</span>,  <span class="hljs-comment"># Latitude (WGS84), in degrees * 1E7</span>
        <span class="hljs-number">0</span>,  <span class="hljs-comment"># Longitude (WGS84), in degrees * 1E7</span>
        <span class="hljs-number">0</span>,  <span class="hljs-comment"># Altitude (AMSL, not WGS84), in m (positive for up)</span>
        <span class="hljs-number">1</span>,  <span class="hljs-comment"># GPS HDOP horizontal dilution of position in m</span>
        <span class="hljs-number">1</span>,  <span class="hljs-comment"># GPS VDOP vertical dilution of position in m</span>
        <span class="hljs-number">0</span>,  <span class="hljs-comment"># GPS velocity in m/s in NORTH direction in earth-fixed NED frame</span>
        <span class="hljs-number">0</span>,  <span class="hljs-comment"># GPS velocity in m/s in EAST direction in earth-fixed NED frame</span>
        <span class="hljs-number">0</span>,  <span class="hljs-comment"># GPS velocity in m/s in DOWN direction in earth-fixed NED frame</span>
        <span class="hljs-number">0</span>,  <span class="hljs-comment"># GPS speed accuracy in m/s</span>
        <span class="hljs-number">0</span>,  <span class="hljs-comment"># GPS horizontal accuracy in m</span>
        <span class="hljs-number">0</span>,  <span class="hljs-comment"># GPS vertical accuracy in m</span>
        <span class="hljs-number">7</span>   <span class="hljs-comment"># Number of satellites visible.</span>
    )
</code></pre>
<h5 id="receive-data-and-filter-by-message-type">Receive data and filter by message type</h5>
<pre><code class="lang-python"><span class="hljs-string">&quot;&quot;&quot;
Example of how to filter for specific mavlink messages coming from the
autopilot using pymavlink
&quot;&quot;&quot;</span>
<span class="hljs-comment"># Import mavutil</span>
<span class="hljs-keyword">from</span> pymavlink <span class="hljs-keyword">import</span> mavutil

<span class="hljs-comment"># Create the connection</span>
<span class="hljs-comment"># From topside computer</span>
master = mavutil.mavlink_connection(<span class="hljs-string">&apos;udpin:0.0.0.0:14550&apos;</span>)

<span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
    msg = master.recv_match()
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> msg:
        <span class="hljs-keyword">continue</span>
    <span class="hljs-keyword">if</span> msg.get_type() == <span class="hljs-string">&apos;HEARTBEAT&apos;</span>:
        print(<span class="hljs-string">&quot;\n\n*****Got message: %s*****&quot;</span> % msg.get_type())
        print(<span class="hljs-string">&quot;Message: %s&quot;</span> % msg)
        print(<span class="hljs-string">&quot;\nAs dictionary: %s&quot;</span> % msg.to_dict())
        <span class="hljs-comment"># Armed = MAV_STATE_STANDBY (4), Disarmed = MAV_STATE_ACTIVE (3)</span>
        print(<span class="hljs-string">&quot;\nSystem status: %s&quot;</span> % msg.system_status)
</code></pre>
<h5 id="send-rangefindercomputer-vision-distance-measurement-to-the-autopilot">Send rangefinder/computer vision distance measurement to the autopilot</h5>
<pre><code class="lang-python"><span class="hljs-string">&quot;&quot;&quot;
Example of how to send MAV_DISTANCE_SENSOR messages to integrate a custom distance sensor
to the autopilot using pymavlink
&quot;&quot;&quot;</span>

<span class="hljs-keyword">import</span> time

<span class="hljs-comment"># Import mavutil</span>
<span class="hljs-keyword">from</span> pymavlink <span class="hljs-keyword">import</span> mavutil

<span class="hljs-comment"># Wait for server connection</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">wait_conn</span><span class="hljs-params">()</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    Sends a ping to the autopilot to stabilish the UDP connection and waits for a reply
    &quot;&quot;&quot;</span>
    msg = <span class="hljs-keyword">None</span>
    <span class="hljs-keyword">while</span> <span class="hljs-keyword">not</span> msg:
        master.mav.ping_send(
            int(time.time() * <span class="hljs-number">1e6</span>), <span class="hljs-comment"># Unix time in microseconds</span>
            <span class="hljs-number">0</span>, <span class="hljs-comment"># Ping number</span>
            <span class="hljs-number">0</span>, <span class="hljs-comment"># Request ping of all systems</span>
            <span class="hljs-number">0</span> <span class="hljs-comment"># Request ping of all components</span>
        )
        msg = master.recv_match()
        time.sleep(<span class="hljs-number">0.5</span>)

<span class="hljs-comment"># Connect to the default listening port for</span>
<span class="hljs-comment"># mavproxy on Blue Robotics companion computer</span>
master = mavutil.mavlink_connection(<span class="hljs-string">&apos;udpout:localhost:9000&apos;</span>)

<span class="hljs-comment"># Send a ping to start connection and wait for any reply.</span>
wait_conn()

<span class="hljs-comment"># Configure the autopilot to use mavlink rangefinder, the autopilot</span>
<span class="hljs-comment"># will need to be rebooted after this to use the updated setting</span>
master.mav.param_set_send(
    <span class="hljs-number">1</span>,
    <span class="hljs-number">1</span>,
    <span class="hljs-string">b&quot;RNGFND_TYPE&quot;</span>,
    <span class="hljs-number">10</span>, <span class="hljs-comment"># &quot;MAVLink&quot;</span>
    mavutil.mavlink.MAV_PARAM_TYPE_INT8)

min_measurement = <span class="hljs-number">10</span> <span class="hljs-comment"># minimum valid measurement that the autopilot should use</span>
max_measurement = <span class="hljs-number">40</span> <span class="hljs-comment"># maximum valid measurement that the autopilot should use</span>
distance = <span class="hljs-number">20</span> <span class="hljs-comment"># You will need to supply the distance measurement</span>
sensor_type = mavutil.mavlink.MAV_DISTANCE_SENSOR_UNKNOWN
sensor_id = <span class="hljs-number">1</span>
orientation = mavutil.mavlink.MAV_SENSOR_ROTATION_PITCH_270 <span class="hljs-comment"># downward facing</span>
covariance = <span class="hljs-number">0</span>

tstart = time.time()
<span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
    time.sleep(<span class="hljs-number">0.5</span>)
    master.mav.distance_sensor_send(
        int((time.time() - tstart) * <span class="hljs-number">1000</span>),
        min_measurement,
        max_measurement,
        distance,
        sensor_type,
        sensor_id,
        orientation,
        covariance)
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="opencv.html" class="navigation navigation-prev " aria-label="Previous page: OpenCV">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="sitl.html" class="navigation navigation-next " aria-label="Next page: SITL">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Pymavlink","level":"4.5","depth":1,"next":{"title":"SITL","level":"4.6","depth":1,"path":"developers/sitl.md","ref":"developers/sitl.md","articles":[]},"previous":{"title":"OpenCV","level":"4.4","depth":1,"path":"developers/opencv.md","ref":"developers/opencv.md","articles":[]},"dir":"ltr"},"config":{"gitbook":">= 3.2.2","theme":"default","variables":{},"plugins":["youtube","richquotes","page-toc-button","collapsible-menu","custom-favicon","toolbar@git+https://github.com/hamishwillee/gitbook-plugin-toolbar.git","-validate-links","include-codeblock"],"pluginsConfig":{"collapsible-menu":{},"youtube":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"richquotes":{"tip":{"alert":"success","picto":"fa-thumbs-o-up"},"aerial":{"alert":"warning","picto":"fa-plane"},"gps":{"alert":"info","picto":"fa-map-marker"},"version":{"alert":"info","picto":"fa fa-refresh fa-spin fa-3x fa-fw"}},"highlight":{},"favicon":"favicon.ico","page-toc-button":{},"custom-favicon":{},"toolbar":{"buttons":[{"label":"Bug tracker","icon":"fa fa-bug","position":"left","url":"https://github.com/bluerobotics/ardusub-gitbook/issues/new?title=Doc+Bug:+{{title}}&body=DESCRIBE+PROBLEM+WITH+DOCS+HERE%0A%0ABug+Page:+[{{title}}]({{url}})"},{"label":"GitHub","icon":"fa fa-github","url":"https://github.com/Ardupilot/ardupilot"},{"label":"Edit page on github","icon":"fa fa-pencil-square-o","position":"left","url":"https://github.com/bluerobotics/ardusub-gitbook/edit/master/{{filepath_lang}}"}]},"include-codeblock":{"check":false,"edit":false,"fixlang":false,"lang":"","template":"default","theme":"chrome","unindent":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"developers/pymavlink.md","mtime":"2020-12-07T14:54:18.054Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-12-07T14:55:32.007Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-page-toc-button/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-collapsible-menu/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-toolbar/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

